<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#070a12" />
  <title>‚ú® Taiwan Adventure for Two ‚ú®</title>
  <style>
    :root{
      --bg0:#070a12;
      --bg1:#0b0f1a;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.04);
      --border:rgba(255,255,255,.12);
      --border2:rgba(255,255,255,.09);
      --text:#eaf2ff;
      --muted:rgba(234,242,255,.78);
      --muted2:rgba(234,242,255,.62);
      --a:#7dd3fc;
      --b:#a78bfa;
      --g:#34d399;
      --r:18px;
      --shadow: 0 18px 60px rgba(0,0,0,.55);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% -10%, rgba(167,139,250,.34), transparent 60%),
        radial-gradient(900px 680px at 95% 5%, rgba(125,211,252,.28), transparent 55%),
        radial-gradient(700px 700px at 45% 115%, rgba(52,211,153,.10), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      line-height:1.35;
      overflow-x:hidden;
    }
    a{ color:var(--a); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    /* ---- Cover ---- */
    .cover{
      position:relative;
      min-height: 100svh;
      display:grid;
      place-items:center;
      padding: 22px 16px 26px;
    }
    .stars, .glow{
      position:absolute; inset:0; pointer-events:none;
    }
    .stars:before{
      content:"";
      position:absolute; inset:-40px;
      background-image:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.60), transparent 55%),
        radial-gradient(1px 1px at 70% 20%, rgba(255,255,255,.45), transparent 55%),
        radial-gradient(1px 1px at 10% 80%, rgba(255,255,255,.35), transparent 55%),
        radial-gradient(2px 2px at 85% 70%, rgba(255,255,255,.40), transparent 55%),
        radial-gradient(1px 1px at 40% 60%, rgba(255,255,255,.30), transparent 55%),
        radial-gradient(1px 1px at 55% 35%, rgba(255,255,255,.35), transparent 55%),
        radial-gradient(1px 1px at 30% 15%, rgba(255,255,255,.28), transparent 55%),
        radial-gradient(1px 1px at 92% 38%, rgba(255,255,255,.28), transparent 55%),
        radial-gradient(2px 2px at 62% 86%, rgba(255,255,255,.34), transparent 55%);
      opacity:.55;
      filter: blur(.2px);
      animation: drift 18s linear infinite;
      transform: translate3d(0,0,0);
    }
    .glow:before{
      content:"";
      position:absolute; inset:-20px;
      background:
        radial-gradient(900px 600px at 35% 25%, rgba(167,139,250,.25), transparent 60%),
        radial-gradient(900px 600px at 75% 35%, rgba(125,211,252,.20), transparent 60%),
        radial-gradient(700px 600px at 55% 80%, rgba(52,211,153,.10), transparent 65%);
      filter: blur(10px);
      opacity:.8;
      animation: pulse 7s ease-in-out infinite;
    }
    @keyframes drift{
      0%{ transform: translateY(0px); }
      50%{ transform: translateY(18px); }
      100%{ transform: translateY(0px); }
    }
    @keyframes pulse{
      0%,100%{ opacity:.75; }
      50%{ opacity: 1; }
    }

    .card{
      width: min(980px, 100%);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 26px;
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .card:before{
      content:"";
      position:absolute; inset:-1px;
      background: linear-gradient(135deg, rgba(125,211,252,.35), rgba(167,139,250,.30), rgba(52,211,153,.18));
      opacity:.35;
      filter: blur(22px);
      z-index:0;
    }
    .cover-inner{
      position:relative;
      z-index:1;
      padding: 26px 18px 18px;
      display:grid;
      gap: 14px;
    }
    .kicker{
      display:flex; flex-wrap:wrap; gap:8px;
      align-items:center;
      justify-content:space-between;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 11px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      font-size: 12px;
      color: var(--muted);
      backdrop-filter: blur(8px);
    }
    .pill b{ color: var(--text); font-weight: 750; }
    .headline{
      margin: 0;
      font-size: clamp(26px, 4.2vw, 44px);
      letter-spacing: .2px;
      line-height: 1.05;
    }
    .subhead{
      margin: 0;
      color: var(--muted);
      font-size: clamp(13px, 2vw, 16px);
      max-width: 60ch;
    }
    .spark{ color: var(--b); }
    .cta-row{ display:flex; flex-wrap:wrap; gap:10px; margin-top: 6px; }
    .btn{
      cursor:pointer;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 800;
      letter-spacing:.2px;
      transition: transform .06s ease, background .15s ease, border-color .15s ease;
    }
    .btn:hover{ background: rgba(255,255,255,.10); border-color: rgba(125,211,252,.45); }
    .btn:active{ transform: scale(.99); }
    .btn.primary{
      background: linear-gradient(135deg, rgba(125,211,252,.22), rgba(167,139,250,.18));
      border-color: rgba(125,211,252,.42);
    }
    .grid3{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
    @media (max-width: 860px){
      .grid3{ grid-template-columns: 1fr; }
    }
    .mini{
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      padding: 12px;
    }
    .mini h3{ margin:0 0 6px; font-size: 13px; }
    .mini p{ margin:0; color: var(--muted); font-size: 12px; }
    .hint{
      margin: 8px 0 0;
      color: rgba(234,242,255,.70);
      font-size: 12px;
    }

    /* ---- Planner header ---- */
    header{
      position:sticky; top:0; z-index:30;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(7,10,18,.86), rgba(7,10,18,.70));
      border-bottom:1px solid rgba(255,255,255,.09);
    }
    .wrap{ max-width: 1100px; margin:0 auto; padding: 16px; }
    .bar{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      flex-wrap:wrap;
    }
    .bar h2{ margin:0; font-size: 14px; letter-spacing:.2px; color: rgba(234,242,255,.92); }
    .bar .right{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .chip{
      display:inline-flex; gap:8px; align-items:center;
      padding: 7px 10px;
      border:1px solid rgba(255,255,255,.10);
      border-radius:999px;
      background: rgba(255,255,255,.05);
      font-size: 12px; color: var(--muted);
    }
    .chip b{ color: var(--text); font-weight: 800; }

    /* ---- Planner layout ---- */
    main .grid{
      display:grid;
      grid-template-columns: 360px 1fr;
      gap: 14px;
      padding-bottom: 60px;
    }
    @media (max-width: 920px){
      main .grid{ grid-template-columns: 1fr; }
      header{ position:relative; }
    }

    .panel{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius: var(--r);
      box-shadow: 0 12px 45px rgba(0,0,0,.40);
      overflow:hidden;
    }
    .panel h3{
      margin:0;
      padding: 14px 14px 10px;
      font-size: 14px;
      border-bottom:1px solid rgba(255,255,255,.09);
      color: rgba(234,242,255,.92);
    }
    .panel .content{ padding: 14px; }

    .datecard{
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      padding: 12px;
      margin-bottom: 12px;
    }
    .datecard label{ display:block; font-size: 12px; color: var(--muted); margin-bottom: 6px; }
    select{
      width:100%;
      padding: 10px 10px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      color: var(--text);
      font-weight: 800;
    }
    .small{
      margin: 8px 0 0;
      color: var(--muted);
      font-size: 12px;
    }

    .daybtn{
      width:100%;
      text-align:left;
      padding: 12px 12px;
      margin: 8px 0;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: var(--text);
      cursor:pointer;
      transition: background .15s ease, border-color .15s ease;
    }
    .daybtn:hover{ background: rgba(255,255,255,.06); border-color: rgba(125,211,252,.35); }
    .daybtn.active{ background: rgba(125,211,252,.16); border-color: rgba(125,211,252,.40); }
    .daybtn small{ display:block; margin-top: 5px; color: var(--muted2); font-weight: 700; }

    .daytitle{ margin:0 0 6px; font-size: 16px; }
    .daydate{ margin:0 0 10px; font-size: 13px; color: var(--muted); }
    .badges{ margin-bottom: 6px; }
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      padding: 5px 8px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      font-size: 11px;
      color: var(--muted);
      margin-right: 6px;
      margin-bottom: 6px;
    }
    .sections{ display:grid; gap: 10px; }
    .sec{
      padding: 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
    }
    .sec h4{ margin:0 0 8px; font-size: 13px; color: rgba(234,242,255,.92); letter-spacing:.15px; }
    ul{ margin: 8px 0 0 18px; padding:0; }
    li{ margin: 6px 0; }

    .checklist{ list-style:none; margin:0; padding:0; }
    .checklist li{ display:flex; gap:10px; align-items:flex-start; padding: 8px 0; cursor:pointer; }
    .box{
      width: 18px; height: 18px; border-radius: 6px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      flex: 0 0 auto; margin-top: 2px;
    }
    .done .box{ background: rgba(52,211,153,.35); border-color: rgba(52,211,153,.60); }
    .foot{
      opacity:.75; font-size: 12px;
      padding: 10px 14px 14px;
      border-top: 1px solid rgba(255,255,255,.09);
    }

    /* Modal */
    .modal{ position:fixed; inset:0; display:none; place-items:center; background: rgba(0,0,0,.65); z-index:60; padding:16px; }
    .modal.open{ display:grid; }
    .modalbox{
      width:min(920px,100%);
      border-radius: 22px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 20px 70px rgba(0,0,0,.65);
      background: linear-gradient(180deg, rgba(17,24,39,.96), rgba(7,10,18,.96));
    }
    .modalhead{ padding: 16px 16px 10px; border-bottom: 1px solid rgba(255,255,255,.08); }
    .modalhead h3{ margin:0; font-size: 16px; }
    .modalbody{ padding: 14px 16px 18px; }
    .close{ float:right; font-weight: 900; border-radius: 14px; padding: 8px 10px; }
  </style>
</head>

<body>
  <!-- Cover -->
  <section class="cover" id="top">
    <div class="stars"></div>
    <div class="glow"></div>

    <div class="card" aria-label="Taiwan trip cover">
      <div class="cover-inner">
        <div class="kicker">
          <span class="pill">üéÅ <b>Christmas Surprise for Melissa</b></span>
          <span class="pill">üë´ <b>2 travelers</b> ‚Ä¢ ü•æ <b>hiking</b> ‚Ä¢ üåô <b>night markets</b></span>
        </div>

        <h1 class="headline">Taiwan Adventure for Two <span class="spark">‚ú®</span><br><span style="font-size:clamp(14px,2.2vw,18px); color: rgba(234,242,255,.86); font-weight:800;">For Melissa üíõ</span></h1>
        <p class="subhead">
          Weekend in <b>Taipei</b>, then a scenic loop through the <b>mountains</b> and the <b>east coast</b>.
          Flights are built in: depart Phoenix <b>Wednesday evening</b>, arrive Taiwan <b>Friday afternoon</b>,
          and return home with a <b>Friday 5:00 PM</b> departure.
        </p>

        <div class="cta-row">
          <button class="btn primary" id="startBtn">Start the itinerary ‚ûú</button>
          <button class="btn" id="openGift">Open the reveal üíù</button>
          <button class="btn" id="toggleChecklistTop">Checklist ‚úÖ</button>
        </div>

        <div class="grid3" role="list" aria-label="Highlights">
          <div class="mini" role="listitem">
            <h3>üèôÔ∏è Taipei Weekend</h3>
            <p>Taipei 101, temples, creative neighborhoods, and the best night markets.</p>
          </div>
          <div class="mini" role="listitem">
            <h3>‚õ∞Ô∏è Mountain Stay</h3>
            <p>Cingjing alpine air + Old England Manor vibes + scenic day hikes.</p>
          </div>
          <div class="mini" role="listitem">
            <h3>üåä East Coast Nature</h3>
            <p>Hualien base with Taroko-area scenery and ocean viewpoints.</p>
          </div>
        </div>

        <p class="hint">Tip: this page works offline once saved to your phone. You can also ‚ÄúAdd to Home Screen‚Äù in Safari.</p>
      </div>
    </div>
  </section>

  <!-- Sticky planner header -->
  <header>
    <div class="wrap">
      <div class="bar">
        <h2>Trip Planner</h2>
        <div class="right">
          <span class="chip">üìÖ <b id="dateRangeText">Select dates</b></span>
          <span class="chip">üõ´ Phoenix: <b>Wed evening</b> ‚Üí Taiwan: <b>Fri afternoon</b></span>
          <span class="chip">üõ¨ Return: <b>Fri</b> (depart 5:00 PM)</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Planner -->
  <main class="wrap" id="planner">
    <div class="grid">
      <aside class="panel">
        <h3>Choose a week (March 18 ‚Üí May 20)</h3>
        <div class="content">
          <div class="datecard">
            <label for="dateSelect">Departure from Phoenix (Wednesday evening)</label>
            <select id="dateSelect" aria-label="Select trip week"></select>
            <p class="small">
              This itinerary automatically places: <b>Fri‚ÄìSat</b> in Taipei, touring <b>Sun‚ÄìThu</b>, and a <b>Friday 5:00 PM</b> departure home.
            </p>
          </div>

          <div id="dayList"></div>
        </div>
        <div class="foot">Tap a day to see details. The plan is activity-focused (no pricing).</div>
      </aside>

      <section class="panel">
        <h3>Day details</h3>
        <div class="content">
          <h4 class="daytitle" id="dayTitle">Select a day</h4>
          <p class="daydate" id="dayDate"></p>
          <div class="badges" id="badges"></div>
          <div class="sections" id="daySections"></div>

          <div class="sec" id="checklist" style="display:none; margin-top: 14px;">
            <h4>Trip checklist (tap to mark done)</h4>
            <ul class="checklist" id="checklistItems"></ul>
            <p class="small">This is just for fun planning. Bookings can happen after the date is chosen.</p>
          </div>
        </div>
        <div class="foot">Links open quick map searches. No bookings are made from this page.</div>
      </section>
    </div>
  </main>

  <!-- Reveal Modal -->
  <div class="modal" id="giftModal" role="dialog" aria-modal="true" aria-labelledby="giftTitle">
    <div class="modalbox">
      <div class="modalhead">
        <button class="btn close" id="closeGift" aria-label="Close">‚úï</button>
        <h3 id="giftTitle">üíù Melissa‚Äôs Taiwan Adventure</h3>
      </div>
      <div class="modalbody">
        <p style="margin:0 0 10px; color: rgba(234,242,255,.78);">Melissa ‚Äî I planned this for us. Pick the week you want, and we‚Äôll make it happen. ‚ú®</p>
        <div class="sec">
          <h4>What‚Äôs included</h4>
          <ul>
            <li><b>Top sights:</b> Taipei 101, famous night markets, cultural neighborhoods, iconic viewpoints</li>
            <li><b>Hiking:</b> Elephant Mountain, Yangmingshan options, Cingjing alpine walks, Taroko-area scenic walks</li>
            <li><b>Vibes:</b> city lights ‚Üí mountain clouds ‚Üí ocean horizon</li>
          </ul>
        </div>
        <div class="sec">
          <h4>Flight rhythm</h4>
          <ul>
            <li>Depart Phoenix: <b>Wednesday evening</b></li>
            <li>Arrive Taiwan: <b>Friday afternoon</b></li>
            <li>Depart Taiwan: <b>Friday 5:00 PM</b> ‚Üí arrive Phoenix: <b>Friday 2:30 PM</b></li>
          </ul>
        </div>
        <p class="small">Pick your favorite week in the selector and everything updates automatically. ‚ú®</p>
      </div>
    </div>
  </div>

  <script>
    const YEAR = 2026;
    const START_WED = new Date(`${YEAR}-03-18T12:00:00`);
    const END_WED   = new Date(`${YEAR}-05-20T12:00:00`);

    function addDays(date, n){
      const d = new Date(date.getTime());
      d.setDate(d.getDate() + n);
      return d;
    }
    const fmtLong = new Intl.DateTimeFormat(undefined, { weekday:"short", month:"short", day:"numeric", year:"numeric" });
    const fmtShort = new Intl.DateTimeFormat(undefined, { weekday:"short", month:"short", day:"numeric" });

    const options = [];
    for (let d = new Date(START_WED); d <= END_WED; d = addDays(d, 7)){
      options.push(new Date(d.getTime()));
    }

    const DAYS = [
      { title:"Day 0 ‚Äî Depart Phoenix (Wednesday evening)", badges:["üõ´ Flight","üåô Overnight travel"],
        sections:[
          { h:"Plan", items:["Depart Phoenix in the evening","Settle in for the long-haul travel (sleep + hydrate!)"]},
          { h:"Little wins", items:["Download offline maps + a few shows/podcasts","Pack a light hoodie + eye mask for the flight"] }
        ]
      },
      { title:"Day 1 ‚Äî Transit day (Thursday)", badges:["‚úàÔ∏è In the air","üßò Pace yourself"],
        sections:[
          { h:"Plan", items:["Travel day (international date line magic)","Keep it easy‚Äîarrive feeling good"]},
          { h:"Arrival prep", items:["Confirm airport-to-hotel directions","Keep essentials in carry-on (charger, toothbrush, meds)"] }
        ]
      },
      { title:"Day 2 ‚Äî Arrive Taipei (Friday afternoon) + night market", badges:["üèôÔ∏è Taipei","üçú Night market","üì∏ First views"],
        sections:[
          { h:"Plan", items:["Arrive in Taipei Friday afternoon + check in","Easy city walk to get oriented","Night market dinner (street food tour!)"]},
          { h:"Top sights (if you‚Äôre energized)", items:["Ximending neon streets","Riverside stroll for skyline photos"] },
          { h:"Maps", items:[
            { text:"Search: Ximending", url:"https://www.google.com/maps/search/?api=1&query=Ximending%2C%20Taipei" },
            { text:"Search: Raohe Night Market", url:"https://www.google.com/maps/search/?api=1&query=Raohe%20Night%20Market%2C%20Taipei" }
          ]}
        ]
      },
      { title:"Day 3 ‚Äî Taipei classics (Saturday): Taipei 101 + sunset hike", badges:["üèôÔ∏è Taipei","ü•æ Elephant Mountain","üåá Sunset view"],
        sections:[
          { h:"Must-do", items:["Taipei 101 area + city views","Elephant Mountain hike for the iconic viewpoint (sunset is perfect)","Second night market (try a different one!)"]},
          { h:"Optional swaps", items:["National Palace Museum","Beitou hot springs evening"] },
          { h:"Maps", items:[
            { text:"Search: Taipei 101", url:"https://www.google.com/maps/search/?api=1&query=Taipei%20101" },
            { text:"Search: Elephant Mountain Trailhead", url:"https://www.google.com/maps/search/?api=1&query=Elephant%20Mountain%20Trail%20Taipei" }
          ]}
        ]
      },
      { title:"Day 4 ‚Äî Sunday: Travel ‚Üí Mountains (Cingjing) + Old England Manor", badges:["‚õ∞Ô∏è Mountains","üè∞ Old England Manor","üì∑ Scenic views"],
        sections:[
          { h:"Plan", items:["Leave Taipei Sunday","Arrive in Cingjing + check in","Afternoon tea / gardens / photos","Cozy dinner + early night (mountain air!)"]},
          { h:"Easy hike option", items:["Short scenic walk near Cingjing (alpine viewpoints)"] },
          { h:"Maps", items:[
            { text:"Search: Old England Manor (Cingjing)", url:"https://www.google.com/maps/search/?api=1&query=Old%20England%20Manor%20Cingjing" },
            { text:"Search: Cingjing Farm", url:"https://www.google.com/maps/search/?api=1&query=Cingjing%20Farm" }
          ]}
        ]
      },
      { title:"Day 5 ‚Äî Mountain day (Monday): alpine walks + big views", badges:["‚õ∞Ô∏è Mountains","ü•æ Hiking","‚òÅÔ∏è Cloud views"],
        sections:[
          { h:"Hiking + scenery", items:["Morning alpine walk (cool air + wide-open views)","Cingjing Farm area (fun + photogenic)","Relaxed afternoon back at the manor"]},
          { h:"Optional adventure", items:["Hehuanshan scenic drive + short trails (weather-dependent)"] },
          { h:"Maps", items:[ { text:"Search: Hehuanshan", url:"https://www.google.com/maps/search/?api=1&query=Hehuanshan" } ] }
        ]
      },
      { title:"Day 6 ‚Äî Tuesday: Mountains ‚Üí East Coast (Hualien) + night market", badges:["üåä East coast","üöó Scenic route","üçú Local eats"],
        sections:[
          { h:"Plan", items:["Travel to Hualien (east coast gateway)","Check in + seaside stroll","Hualien night market dinner"]},
          { h:"Optional stop ideas", items:["Coastal viewpoints for photos","Coffee stop in town"] },
          { h:"Maps", items:[
            { text:"Search: Hualien", url:"https://www.google.com/maps/search/?api=1&query=Hualien%2C%20Taiwan" },
            { text:"Search: Dongdamen Night Market", url:"https://www.google.com/maps/search/?api=1&query=Dongdamen%20Night%20Market%20Hualien" }
          ]}
        ]
      },
      { title:"Day 7 ‚Äî East Coast nature day (Wednesday): Taroko-area scenery + short walks", badges:["üèûÔ∏è Nature","üì∏ Iconic views","ü•æ Scenic walks"],
        sections:[
          { h:"Scenic plan (flexible)", items:["Spend the day on Taroko-area viewpoints + short walks","Focus on safe open areas (conditions can vary)","Back to Hualien for a relaxed dinner"]},
          { h:"Walking goals", items:["Riverside viewpoints","Short waterfall walk (when open)","Gorge photo stops"] },
          { h:"Maps", items:[ { text:"Search: Taroko National Park", url:"https://www.google.com/maps/search/?api=1&query=Taroko%20National%20Park" } ] }
        ]
      },
      { title:"Day 8 ‚Äî Thursday: Return to Taipei + final night", badges:["üèôÔ∏è Taipei","üõçÔ∏è Shopping","üçΩÔ∏è Final dinner"],
        sections:[
          { h:"Plan", items:["Return to Taipei on Thursday","Final shopping stroll + one special dinner","Optional: light night market snack run"]},
          { h:"Great final-night ideas", items:["Dihua Street (tea, shops, vibe)","Riverside walk or rooftop views"] },
          { h:"Maps", items:[ { text:"Search: Dihua Street", url:"https://www.google.com/maps/search/?api=1&query=Dihua%20Street%2C%20Taipei" } ] }
        ]
      },
      { title:"Day 9 ‚Äî Depart Taiwan (Friday 5:00 PM) ‚Üí Arrive Phoenix (Friday 2:30 PM)", badges:["üõ´ Flight home","üïî 5:00 PM depart","üõ¨ Same-day arrival"],
        sections:[
          { h:"Plan", items:["Easy morning: brunch + one last stroll","Head to the airport with time to spare","Depart Friday at 5:00 PM ‚Üí arrive Phoenix Friday at 2:30 PM"]},
          { h:"If time allows", items:["Souvenirs: tea + pineapple cakes","One last bubble tea for the road"] }
        ]
      }
    ];

    const CHECKLIST = [
      "Pick the week (Wed departure) from the selector",
      "Choose Taipei hotel vibe (central & walkable vs more resorty)",
      "Hiking shoes + light daypack ready",
      "Make a ‚Äòmust-eat‚Äô night market list",
      "Create a shared photo album",
      "Pick one ‚Äúspecial dinner‚Äù night in Taipei",
      "Confirm comfort items for long flights (eye mask, hoodie, chargers)"
    ];

    // DOM
    const dateSelect = document.getElementById("dateSelect");
    const dateRangeText = document.getElementById("dateRangeText");
    const dayList = document.getElementById("dayList");
    const dayTitle = document.getElementById("dayTitle");
    const dayDate = document.getElementById("dayDate");
    const badgesEl = document.getElementById("badges");
    const daySections = document.getElementById("daySections");
    const checklistBox = document.getElementById("checklist");
    const checklistItems = document.getElementById("checklistItems");

    const startBtn = document.getElementById("startBtn");
    const toggleChecklistTop = document.getElementById("toggleChecklistTop");

    const giftModal = document.getElementById("giftModal");
    const openGift = document.getElementById("openGift");
    const closeGift = document.getElementById("closeGift");

    let currentStart = options[3] || options[0]; // default early April-ish
    let checklistState = new Array(CHECKLIST.length).fill(false);

    function setDateRangeLabel(){
      const dep = currentStart;
      const ret = addDays(dep, 9);
      dateRangeText.textContent = `${fmtShort.format(dep)} ‚Üí ${fmtShort.format(ret)} (${YEAR})`;
    }

    function renderBadges(list){
      badgesEl.innerHTML = list.map(b => `<span class="badge">${b}</span>`).join("");
    }

    function renderSections(secs){
      let html = "";
      secs.forEach(s => {
        html += `<div class="sec"><h4>${s.h}</h4><ul>`;
        s.items.forEach(it => {
          if (typeof it === "string") html += `<li>${it}</li>`;
          else if (it && it.text && it.url) html += `<li><a href="${it.url}" target="_blank" rel="noopener noreferrer">${it.text}</a></li>`;
        });
        html += `</ul></div>`;
      });
      daySections.innerHTML = html;
    }

    function dayDateForIndex(i){ return addDays(currentStart, i); }

    function buildDayButtons(){
      dayList.innerHTML = "";
      DAYS.forEach((day, i) => {
        const d = dayDateForIndex(i);
        const btn = document.createElement("button");
        btn.className = "daybtn";
        btn.innerHTML = `<strong>${day.title}</strong><small>${fmtLong.format(d)}</small>`;
        btn.onclick = () => renderDay(i);
        dayList.appendChild(btn);
      });
    }

    function renderDay(i){
      document.querySelectorAll(".daybtn").forEach((b, idx) => b.classList.toggle("active", idx === i));
      const day = DAYS[i];
      const d = dayDateForIndex(i);
      dayTitle.textContent = day.title;
      dayDate.textContent = fmtLong.format(d);
      renderBadges(day.badges);
      renderSections(day.sections);
    }

    function buildDateOptions(){
      dateSelect.innerHTML = "";
      options.forEach((d) => {
        const dep = d;                 // Wed
        const arrive = addDays(dep, 2);// Fri
        const ret = addDays(dep, 9);   // Fri
        const opt = document.createElement("option");
        opt.value = dep.toISOString().slice(0,10);
        opt.textContent = `Depart Wed ${fmtShort.format(dep)} ‚Üí Return Fri ${fmtShort.format(ret)} (Arrive Taiwan Fri ${fmtShort.format(arrive)})`;
        dateSelect.appendChild(opt);
      });
      dateSelect.value = currentStart.toISOString().slice(0,10);
    }

    function renderChecklist(){
      checklistItems.innerHTML = "";
      CHECKLIST.forEach((t, idx) => {
        const li = document.createElement("li");
        li.className = checklistState[idx] ? "done" : "";
        li.innerHTML = `<span class="box" aria-hidden="true"></span><span>${t}</span>`;
        li.onclick = () => { checklistState[idx] = !checklistState[idx]; renderChecklist(); };
        checklistItems.appendChild(li);
      });
    }

    function toggleChecklist(){
      const open = checklistBox.style.display !== "none";
      checklistBox.style.display = open ? "none" : "block";
      if (!open) renderChecklist();
      checklistBox.scrollIntoView({ behavior:"smooth", block:"start" });
    }

    dateSelect.addEventListener("change", (e) => {
      const val = e.target.value; // YYYY-MM-DD
      currentStart = new Date(`${val}T12:00:00`);
      setDateRangeLabel();
      buildDayButtons();
      renderDay(2); // default to Fri arrival day
    });

    startBtn.addEventListener("click", () => {
      document.getElementById("planner").scrollIntoView({ behavior:"smooth", block:"start" });
    });
    toggleChecklistTop.addEventListener("click", toggleChecklist);

    openGift.addEventListener("click", () => giftModal.classList.add("open"));
    closeGift.addEventListener("click", () => giftModal.classList.remove("open"));
    giftModal.addEventListener("click", (e) => { if (e.target === giftModal) giftModal.classList.remove("open"); });

    // Init
    buildDateOptions();
    setDateRangeLabel();
    buildDayButtons();
    renderDay(2);
    renderChecklist();
  </script>
</body>
</html>
